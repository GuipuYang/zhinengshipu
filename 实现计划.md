# AI 食谱生成器 - 功能需求与实现方案

## 一、核心功能模块

### 1. 食材输入系统

**核心功能：**
- 分类选择食材（蔬菜、肉类、海鲜、调味料等）
- 搜索添加食材
- 自由输入食材
- 输入食材数量/状态（如 200g 鸡肉）
- 保存常用食材组合

**用户操作流程：**
1. 进入首页/食材输入页
2. 选择输入方式：
   - 点击分类标签 → 选择具体食材 → 输入数量
   - 使用搜索框 → 输入关键词 → 选择匹配项 → 输入数量
   - 点击"自由输入" → 手动输入食材名称和数量
3. 已添加食材显示在列表中，可编辑/删除
4. 点击"保存组合"可将当前食材列表保存为常用组合
5. 点击"生成菜谱"进入下一步

**页面元素：**
- 分类标签栏（蔬菜、肉类、海鲜、豆制品、调味料等）
- 搜索输入框（带自动补全）
- 食材卡片网格（每个分类下的食材）
- 已选食材列表（显示名称、数量、删除按钮）
- 数量输入框/选择器
- "保存组合"按钮
- "加载常用组合"下拉菜单
- "生成菜谱"主按钮

**数据存储：**
```javascript
// 食材库（预设数据）
ingredients_library: {
  id: string,
  name: string,
  category: string, // 蔬菜、肉类、海鲜等
  common_units: string[], // ["克", "个", "根"]
  aliases: string[] // 搜索别名
}

// 用户输入的食材
user_ingredients: {
  ingredient_id: string,
  name: string,
  quantity: string, // "200g", "2个"
  added_time: timestamp
}

// 常用组合
saved_combinations: {
  id: string,
  name: string,
  ingredients: user_ingredients[],
  created_time: timestamp
}
```

---

### 2. AI 智能食谱生成

**核心功能：**
- 基于输入食材生成 3-5 道菜谱
- 每道菜谱包含：创意名称、已有/缺少食材、分步做法、烹饪时间、难度等级

**用户操作流程：**
1. 点击"生成菜谱"按钮
2. 系统显示加载动画（AI 生成中）
3. 展示 3-5 道菜谱卡片
4. 点击任意菜谱卡片查看详情
5. 在详情页可查看完整做法、食材清单、营养信息等

**页面元素：**
- 加载动画/进度提示
- 菜谱卡片列表：
  - 菜谱名称
  - 缩略图（可选）
  - 难度标签（简单/中等/复杂）
  - 烹饪时间标签
  - 已有食材匹配度（如 80% 匹配）
  - "查看详情"按钮
- 菜谱详情页：
  - 菜谱名称
  - 难度、时间、份量
  - 已有食材列表（绿色标记）
  - 缺少食材列表（红色标记）
  - 分步做法（编号列表）
  - 收藏按钮
  - 生成购物清单按钮

**数据存储：**
```javascript
// 生成的菜谱
generated_recipes: {
  id: string,
  name: string,
  difficulty: string, // "简单", "中等", "复杂"
  cooking_time: number, // 分钟
  servings: number, // 份数
  ingredients_available: string[], // 已有食材 ID
  ingredients_missing: string[], // 缺少食材 ID
  steps: string[], // 做法步骤
  tips: string, // 烹饪小贴士
  generated_time: timestamp,
  user_id: string
}
```

---

### 3. 筛选与排序功能

**核心功能：**
- 按菜系筛选（中餐、西餐、日韩料理等）
- 按口味筛选（辣、甜、咸、酸等）
- 按烹饪时间筛选（15 分钟内/30 分钟内/1 小时内）
- 按难度筛选（新手友好/家常菜/大厨级）

**用户操作流程：**
1. 在菜谱列表页点击"筛选"按钮
2. 弹出筛选面板
3. 选择筛选条件（可多选）
4. 点击"应用"，列表实时更新
5. 可点��排序按钮（时间升序/降序、难度升序/降序）

**页面元素：**
- 筛选按钮（带筛选条件数量徽章）
- 筛选面板：
  - 菜系选择器（单选或多选）
  - 口味标签（多选）
  - 时间滑块/选择器
  - 难度选择器
  - "重置"和"应用"按钮
- 排序下拉菜单
- 当前筛选条件标签（可点击删除）

**数据存储：**
```javascript
// 筛选条件（前端状态管理）
filter_criteria: {
  cuisine: string[], // ["中餐", "西餐"]
  taste: string[], // ["辣", "甜"]
  time_range: {min: number, max: number}, // 分钟
  difficulty: string[] // ["简单", "中等"]
}

// 菜谱扩展字段
recipes: {
  ...existing_fields,
  cuisine: string, // 菜系
  taste_tags: string[], // 口味标签
}
```

---

### 4. 收藏与管理功能

**核心功能：**
- 收藏菜谱
- 标记已尝试菜谱并添加评价
- 浏览历史生成记录
- 导出菜谱（文本/图片格式）

**用户操作流程：**
1. **收藏菜谱：**
   - 在菜谱详情页点击"收藏"按钮
   - 收藏成功提示
   - 在"我的收藏"页面查看所有收藏

2. **标记已尝试：**
   - 在菜谱详情页点击"标记已做"
   - 弹出评价弹窗（评分、文字评价、上传图片）
   - 提交后在"我的尝试"页面查看

3. **历史记录：**
   - 点击"历史记录"查看所有生成记录
   - 按时间倒序排列
   - 可重新查看任意历史菜谱

4. **导出菜谱：**
   - 在菜谱详情页点击"导出"
   - 选择格式（文本/图片）
   - 下载或分享

**页面元素：**
- 收藏按钮（空心/实心切换）
- "标记已做"按钮
- 评价弹窗：
  - 星级评分
  - 文字输入框
  - 图片上传区
  - 提交按钮
- "我的收藏"页面（菜谱卡片列表）
- "我的尝试"页面（带评价的菜谱列表）
- "历史记录"页面（按日期分组的生成记录）
- 导出按钮和格式选择菜单

**数据存储：**
```javascript
// 收藏记录
favorites: {
  id: string,
  user_id: string,
  recipe_id: string,
  created_time: timestamp
}

// 尝试记录
tried_recipes: {
  id: string,
  user_id: string,
  recipe_id: string,
  rating: number, // 1-5 星
  comment: string,
  images: string[], // 图片 URL
  tried_time: timestamp
}

// 历史记录
generation_history: {
  id: string,
  user_id: string,
  input_ingredients: user_ingredients[],
  generated_recipes: string[], // recipe_id 数组
  created_time: timestamp
}
```

---

## 二、进阶拓展功能

### 5. 智能食材替代

**核心功能：**
- 缺少食材时推荐替代品
- 提供替代后的步骤调整建议

**用户操作流程：**
1. 在菜谱详情页查看缺少食材列表
2. 点击缺少食材旁的"查找替代"按钮
3. 显示 2-3 个替代建议（相似度、易获取性）
4. 选择替代品后，系统自动调整做法步骤
5. 显示调整后的完整菜谱

**页面元素：**
- 缺少食材列表中的"查找替代"按钮
- 替代品推荐卡片：
  - 替代品名称
  - 相似度标签
  - 易获取性标签
  - 简短说明
  - "使用此替代"按钮
- 步骤调整提示（高亮显示变更部分）

**数据存储：**
```javascript
// 食材替代关系（预设数据）
ingredient_substitutes: {
  ingredient_id: string,
  substitutes: [
    {
      substitute_id: string,
      similarity_score: number, // 0-1
      availability_score: number, // 0-1
      notes: string // 替代说明
    }
  ]
}

// 用户选择的替代记录
user_substitutions: {
  recipe_id: string,
  original_ingredient: string,
  substitute_ingredient: string,
  adjusted_steps: string[] // 调整后的步骤
}
```

---

### 6. 购物清单生成

**核心功能：**
- 自动生成需购买食材清单
- 按超市区域分类
- 支持编辑清单
- 导出到手机或打印

**用户操作流程：**
1. 在菜谱详情页点击"生成购物清单"
2. 系统自动提取缺少食材
3. 显示购物清单页面（按区域分类）
4. 可编辑数量、添加备注、勾选已购买
5. 点击"导出"选择格式（文本/图片/打印）

**页面元素：**
- "生成购物清单"按钮
- 购物清单页面：
  - 按区域分组的食材列表（蔬菜区、肉类区等）
  - 每项食材：
    - 复选框（已购买标记）
    - 食材名称
    - 数量输入框
    - 备注输入框
    - 删除按钮
  - "添加食材"按钮
  - 导出按钮（文本/图片/打印）
- 导出预览弹窗

**数据存储：**
```javascript
// 购物清单
shopping_lists: {
  id: string,
  user_id: string,
  recipe_ids: string[], // 关联的菜谱
  items: [
    {
      ingredient_id: string,
      name: string,
      quantity: string,
      category: string, // 超市区域
      notes: string,
      is_purchased: boolean
    }
  ],
  created_time: timestamp,
  updated_time: timestamp
}
```

---

### 7. 营养分析功能

**核心功能：**
- 估算菜品热量
- 分析主要营养成分（蛋白质、碳水、脂肪）
- 提供饮食建议
- 过敏原提示

**用户操作流程：**
1. 在菜谱详情页点击"营养分析"标签
2. 查看营养成分图表和数据
3. 查看饮食建议（如高蛋白、低脂）
4. 查看过敏原警告（如有）

**页面元素：**
- "营养分析"标签页
- 营养成分卡片：
  - 总热量（大字显示）
  - 营养成分饼图/柱状图
  - 详细数据列表（蛋白质、碳水、脂肪、纤维等）
- 饮食建议卡片（标签形式）
- 过敏原警告（醒目标识）

**数据存储：**
```javascript
// 食材营养数据（预设数据）
ingredient_nutrition: {
  ingredient_id: string,
  per_100g: {
    calories: number, // 千卡
    protein: number, // 克
    carbs: number,
    fat: number,
    fiber: number
  },
  allergens: string[] // ["坚果", "海鲜"]
}

// 菜谱营养分析（计算结果）
recipe_nutrition: {
  recipe_id: string,
  total_calories: number,
  nutrients: {
    protein: number,
    carbs: number,
    fat: number,
    fiber: number
  },
  dietary_tags: string[], // ["高蛋白", "低脂"]
  allergens: string[]
}
```

---

### 8. 智能优化建议

**核心功能：**
- 根据剩余食材推荐次日菜谱
- 推荐当季新鲜食材菜谱
- 推荐经济实惠的预算友好型菜谱

**用户操作流程：**
1. 在首页或菜谱列表页查看"智能推荐"区域
2. 系统自动分析：
   - 上次使用后的剩余食材
   - 当前季节
   - 用户预算偏好
3. 显示推荐菜谱卡片（带推荐理由）
4. 点击查看详情或直接生成

**页面元素：**
- "智能推荐"区域（首页顶部或独立页面）
- 推荐卡片：
  - 推荐标签（"剩余食材利用"/"当季推荐"/"预算友好"）
  - 菜谱名称和缩略图
  - 推荐理由（简短文字）
  - "查看详情"按钮
- 推荐设置（用户可调整预算范围、偏好等）

**数据存储：**
```javascript
// 剩余食材记录
remaining_ingredients: {
  user_id: string,
  ingredients: [
    {
      ingredient_id: string,
      quantity: string,
      last_used: timestamp
    }
  ]
}

// 当季食材数据（预设）
seasonal_ingredients: {
  season: string, // "春", "夏", "秋", "冬"
  month: number,
  ingredients: string[] // ingredient_id 数组
}

// 用户偏好设置
user_preferences: {
  user_id: string,
  budget_range: {min: number, max: number}, // 元
  dietary_restrictions: string[], // ["素食", "无海鲜"]
  preferred_cuisines: string[]
}
```

---

## 三、页面结构总览

### 主要页面：

1. **首页/食材输入页**
   - 食材分类选择
   - 搜索框
   - 已选食材列表
   - 智能推荐区域
   - 生成菜谱按钮

2. **菜谱列表页**
   - 筛选/排序工具栏
   - 菜谱卡片网格
   - 分页/无限滚动

3. **菜谱详情页**
   - 菜谱基本信息
   - 食材清单（已有/缺少）
   - 分步做法
   - 营养分析标签页
   - 操作按钮（收藏、标记已做、生成购物清单、导出）

4. **我的收藏页**
   - 收藏的菜谱列表
   - 搜索/筛选功能

5. **我的尝试页**
   - 已尝试菜谱列表（带评价）
   - 按评分/时间排序

6. **历史记录页**
   - 按日期分组的生成记录
   - 可重新查看任意记录

7. **购物清单页**
   - 按区域分组的食材列表
   - 编辑/导出功能

8. **个人设置页**
   - 常用食材组合管理
   - 偏好设置（预算、饮食限制等）
   - 账户信息

---

## 四、数据库设计总结

### 核心数据表：

1. **users** - 用户信息
2. **ingredients_library** - 食材库（预设）
3. **user_ingredients** - 用户输入的食材
4. **saved_combinations** - 常用食材组合
5. **recipes** - 生成的菜谱
6. **favorites** - 收藏记录
7. **tried_recipes** - 尝试记录
8. **generation_history** - 生成历史
9. **shopping_lists** - 购物清单
10. **ingredient_nutrition** - 食材营养数据（预设）
11. **ingredient_substitutes** - 食材替代关系（预设）
12. **seasonal_ingredients** - 当季食材（预设）
13. **user_preferences** - 用户偏好设置

### 存储方案：

- **前端：** LocalStorage（临时数据、用户偏好）
- **后端：**
  - 关系型数据库（MySQL/PostgreSQL）：用户数据、菜谱、收藏等
  - NoSQL（MongoDB）：灵活的菜谱内容、AI 生成结果
  - 对象存储（OSS）：用户上传的图片
  - 缓存（Redis）：热门菜谱、食材库

---

## 五、技术栈建议

### 前端：
- **框架：** React / Vue.js
- **UI 组件库：** Ant Design / Material-UI
- **状态管理：** Redux / Vuex / Zustand
- **路由：** React Router / Vue Router
- **HTTP 客户端：** Axios
- **图表：** ECharts / Chart.js（营养分析）

### 后端：
- **语言：** Node.js (Express) / Python (FastAPI/Django)
- **AI 集成：** OpenAI API / Claude API / 本地模型
- **数据库：** PostgreSQL + MongoDB
- **缓存：** Redis
- **文件存储：** AWS S3 / 阿里云 OSS

### 部署：
- **前端：** Vercel / Netlify
- **后端：** AWS / 阿里云 / Docker + Kubernetes
- **CI/CD：** GitHub Actions

---

## 六、开发优先级建议

### MVP（最小可行产品）- 第一阶段：
1. 食材输入系统（基础版）
2. AI 菜谱生成（核心功能）
3. 菜谱详情展示
4. 基础收藏功能

### 第二阶段：
1. 筛选与排序
2. 历史记录
3. 导出功能
4. 购物清单生成

### 第三阶段：
1. 营养分析
2. 智能食材替代
3. 智能优化建议
4. 用户评价系统

### 第四阶段（创新功能）：
1. 社区分享功能
2. 语音输入食材
3. 图像识别食材
4. 个性化推荐算法优化
5. 多人协作菜谱（家庭共享）

---

## 七、关键技术难点

1. **AI 菜谱生成质量：**
   - 需要精心设计 Prompt
   - 考虑食材搭配的合理性
   - 生成内容的可靠性验证

2. **食材匹配算法：**
   - 模糊搜索和智能推荐
   - 食材替代的相似度计算

3. **营养计算准确性：**
   - 需要完整的食材营养数据库
   - 考虑烹饪过程中的营养损失

4. **用户体验优化：**
   - 快速响应（AI 生成可能较慢）
   - 移动端适配
   - 离线功能支持

5. **成本控制：**
   - AI API 调用成本
   - 图片存储成本
   - 服务器资源优化

---

## 八、未来扩展方向

1. **社交功能：**
   - 用户分享自己的菜谱
   - 评论和点赞系统
   - 关注其他用户

2. **智能硬件集成：**
   - 连接智能冰箱自动识别食材
   - 连接智能厨电（烤箱、电饭煲）

3. **视频教学：**
   - 嵌入烹饪视频
   - AI 生成分步视频教程

4. **多语言支持：**
   - 国际化菜谱
   - 多语言界面

5. **商业化功能：**
   - 食材电商对接
   - 厨具推荐
   - 会员订阅服务

---

**文档版本：** v1.0
**最后更新：** 2026-01-29
